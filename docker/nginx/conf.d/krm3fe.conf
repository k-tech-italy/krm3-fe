server {
    listen 80;
    server_name krm3.local default;

    server_tokens off;
    root /dev/null;

    access_log                /var/log/nginx/krm3_access.log;
    error_log                 /var/log/nginx/krm3_error.log;


#    location / {
#        proxy_read_timeout	300;
#        proxy_connect_timeout   300;
#        proxy_redirect          off;
#
#        proxy_set_header        Host                $http_host;
#        proxy_set_header        X-Real-IP           $remote_addr;
#        proxy_set_header        X-Forwarded-For     $proxy_add_x_forwarded_for;
#        proxy_set_header        X-Forwarded-Proto   https;
#        proxy_set_header        X-Frame-Options     SAMEORIGIN;
#
#    	proxy_set_header X-NginX-Proxy true;
#    	proxy_set_header Client-IP $remote_addr;
#    	proxy_set_header X-Host $host;
#
#    	proxy_pass http://krm3int-fe:3000;
#    }

#    location /static {
#        alias /usr/share/nginx/html/krm3int;
#    }

    location ~ (/static/.*|/admin/.*|/media/.*|/api/.*|/oauth/.*|/__debug__/.*) {

        proxy_read_timeout	300;
        proxy_connect_timeout   300;
        proxy_redirect          off;

        proxy_set_header        Host                $http_host;
        proxy_set_header        X-Real-IP           $remote_addr;
        proxy_set_header        X-Forwarded-For     $proxy_add_x_forwarded_for;
        proxy_set_header        X-Forwarded-Proto   https;
        proxy_set_header        X-Frame-Options     SAMEORIGIN;

    	proxy_set_header X-NginX-Proxy true;
    	proxy_set_header Client-IP $remote_addr;
    	proxy_set_header X-Host $host;

    	proxy_pass http://172.17.0.1:8000;
    }

    location / {

        proxy_read_timeout	300;
        proxy_connect_timeout   300;
        proxy_redirect          off;

        proxy_set_header        Host                $http_host;
        proxy_set_header        X-Real-IP           $remote_addr;
        proxy_set_header        X-Forwarded-For     $proxy_add_x_forwarded_for;
        proxy_set_header        X-Forwarded-Proto   https;
        proxy_set_header        X-Frame-Options     SAMEORIGIN;

    	proxy_set_header X-NginX-Proxy true;
    	proxy_set_header Client-IP $remote_addr;
    	proxy_set_header X-Host $host;

    	proxy_pass http://krm3_fe:3000;
    }

}


